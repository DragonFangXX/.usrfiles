#!/bin/bash

dir=~/.dotfiles
dir_old=~/dotfiles_old
files=$(ls $dir)
exclude=README.md
echo "Creating backup in ~/dotfiles_old"
mkdir -p $dir_old
echo "done"

for file in $files
do
	for excluded in $exclude
	do
		if [[ $file == $exclude  ]]
		then
			flag=1
			break
		fi
	done
	
	if [[ $flag == 1  ]]
	then
		echo "Skipping $file..."
	else

		if [[ $file == bin ]]
		then
			echo "Moving $file to $dir_old"
			mv ~/$file $dir_old/
			echo "Creating symlink to $file in $HOME"
			ln -s $dir/$file ~/$file
		else
			echo "Moving $file to $dir_old"
			mv ~/.$file $dir_old/
			echo "Creating symlink to $file in $HOME"
			ln -s $dir/$file ~/.$file
		fi	
	fi
	flag=0
done
